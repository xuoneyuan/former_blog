---
layout:     post
title:      利用Java实现md5加密
subtitle:   Springboot-SpringSecurity
date:       2023-6-29
author:     xuoneyuan
header-img: 
catalog: false
tags:
    - 密码学
    - Java
---

## md5加密算法
### 简介
MD5 is a cryptographic hash function algorithm that takes the message as input of any length and changes it into a fixed-length message of 16 bytes. MD5 algorithm stands for the message-digest algorithm.The output of MD5 (Digest size) is always 128 bits. 

### md5特点
- Hash function
- Irreversibility

### md5加密原理
1. Padding data: The input data is padded to meet specific requirements, ensuring its length is a multiple of 512 bits. Padding involves appending a "1" bit to the end of the data and adding enough "0" bits to satisfy the condition of the length being congruent to 448 modulo 512.
2. Adding length information: The length of the padded data (in bits) is represented as a 64-bit binary number and appended to the end of the padded data. Length(original message + padding bits) =  512 * i – 64 where i = 1,2,3 . . . 
3. Initializing variables: MD5 uses four 32-bit registers (A, B, C, D) as initial values for its internal state.
4. Group processing: The padded data is divided into several 512-bit blocks, and each block is processed individually.
5. Four-round loop compression: Each block undergoes a four-round loop compression operation. Each round consists of 16 steps involving bitwise operations (such as AND, OR, NOT, XOR), modulo operations, logical functions (such as AND, NOT, OR), and circular left shifts.
![2]({{site.baseurl}}/img-post/md5-cry.png)
6. Outputting the result: The final output is obtained by adding the result of the last round to the initial values and concatenating them in a specific byte order to form a 128-bit hash value.

![1]({{site.baseurl}}/img-post/MD5.png)
## MessageDigest
MessageDigest是Java编程语言中的一个类，MessageDigest 类为应用程序提供信息摘要算法的功能，如 MD5 或 SHA 算法。信息摘要是安全的单向哈希函数，它接收任意大小的数据，并输出固定长度的哈希值。

MessageDigest通过其getInstance系列静态函数来进行实例化和初始化。该对象通过使用 update 方法处理数据。任何时候都可以调用 reset 方法重置摘要。一旦所有需要更新的数据都已经被更新了，应该调用 digest 方法之一完成哈希计算。

对于给定数量的更新数据，digest 方法只能被调用一次。digest 被调用后，MessageDigest 对象被重新设置成其初始状态。

## code
~~~java
import java.security.MessageDigest;

public class MD5Util {

    private static final String SALT = "tamboo";

    public static String encode(String password) {
        password = password + SALT;//定义一个私有静态常量SALT作为加盐值，用于增加密码的复杂度
        MessageDigest md5 = null;
        try {
            md5 = MessageDigest.getInstance("MD5");
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
        char[] charArray = password.toCharArray();
        byte[] byteArray = new byte[charArray.length];
//将密码转换为字符数组，并创建一个字节数组，将字符数组中的每个字符转换为相应的字节
        for (int i = 0; i < charArray.length; i++)
            byteArray[i] = (byte) charArray[i];
        byte[] md5Bytes = md5.digest(byteArray);
        StringBuffer hexValue = new StringBuffer();
        for (int i = 0; i < md5Bytes.length; i++) {
            int val = ((int) md5Bytes[i]) & 0xff;
            if (val < 16) {
                hexValue.append("0");
            }
//遍历MD5摘要的字节数组，将每个字节转换为无符号整数，并将其转换为对应的十六进制字符串。如果转换后的字符串长度小于2位，则在其前面补零
            hexValue.append(Integer.toHexString(val));
        }
        return hexValue.toString();
    }

    public static void main(String[] args) {
        System.out.println(MD5Util.encode("abel"));
    }
}
~~~
